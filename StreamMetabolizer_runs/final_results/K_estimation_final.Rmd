---
title: "K estimation"
author: "MKAUFMAN"
date: "`r Sys.Date()`"
output: html_document
---
##Matthew Kaufman
#matthew.kaufman@pnnl.gov 
#Pacific Nortwest National Laboratory River Corridor SFA
#This script takes measured and modeled hydraulic conditions (velocity, slope, depth, and discharge) for various stream reaches and applies an empirical formula to estimate K600 from them

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## import depth and width data, slope data, discharge and velocity data, and combine
```{r message=FALSE}
data1<-read.csv("SSS_Water_Depth_Summary.csv",skip=8)
data2<-read.csv("SSS_RC2_NWMv2.1_flow_velocity_AugAveraged_v2.csv")
colnames(data2)<-c("Site_ID","comid","discharge","velocity")
data3<-read.csv("Slope_NHD_for_K600_estimation.csv")
colnames(data3)<-c("Site_ID","slope")
data1$Average_Depth_m=data1$Average_Depth/100
data1 <-data1[order(data1$Site_ID),]
data2 <-data2[order(data2$Site_ID),]
data3 <-data3[order(data3$Site_ID),]
data = cbind.data.frame(data1$Site_ID,data1$Average_Depth_m,data2$discharge,data2$velocity,data3$slope)
colnames(data)<-c("Site_ID","Average_Depth_m","discharge","velocity","slope")
```


## Estamate k600 using Raymond 2012 table 2 equation 7:  k600=4725 · (VS)^0.86 · Q^-0.14 · D^0.66
#k600 [m/d], velocity V [m/s], slpe S [-], depth D [m], discharge Q [m^3/s]

```{r message=FALSE}
data$k600_md<-4725*(data$velocity*data$slope)^0.86*data$discharge^-0.14*data$Average_Depth_m^0.66

output<-data.frame(data[c("Site_ID","k600_md")])

write.csv(output,file='k600.csv')
```